"""
匿名化（マスキング）の設定を管理する構成ファイルです。
"""

# --- NLP エンジン設定 ---
# spaCy のモデルなどを指定します
NLP_CONFIG = {
    "nlp_engine_name": "spacy",
    "models": [
        {
            "lang_code": "ja", 
            "model_name": "ja_core_news_lg"
        }
    ],
}

# --- 検出設定 ---

# 検出の閾値 (0.0 - 1.0)
# スコアがこの値以上の場合に PII として認識されます
DEFAULT_SCORE_THRESHOLD = 0.85

# 匿名化の対象とするエンティティ
TARGET_ENTITIES = [
    "PERSON",
    "ORG",
    "ORGANIZATION",  # Presidioが返す可能性がある形式
    "LOCATION",  # 住所を秘匿化するために追加
    "PHONE_NUMBER",
    "EMAIL_ADDRESS",
    "CREDIT_CARD",
    "MY_NUMBER",
    "DRIVERS_LICENSE",
    "PASSPORT",
    "BANK_ACCOUNT",
    "TAX_NUMBER",
    "PASSWORD",
    "SECRET_KEY",
    "CERTIFICATE",
    "SECURITY_CODE",
    "PIN"  # 暗証番号（PINコード）
]

# 除外リスト (PII として検知させたくない単語)
# 一般的な単語のみを最小限に保持（サンプル特化の単語は削除）
ALLOW_LIST = [
    # 一般的な技術用語
    "http",
    "https",
    "example.com",
    # 一般的なフィールド名（文脈上PIIではない）
    "Host",
    "Username",
]

# --- カスタム Recognizer のスコア設定 ---
# コンテキストなしのベーススコアを低めに設定し、コンテキストベースの動的調整を重視
JP_PHONE_SCORE = 0.65  # コンテキストなしのベーススコアを下げ、周辺単語での底上げを狙う
EMAIL_SCORE = 0.95      # メールアドレスは形式が独特なので高めで維持
CC_SCORE = 0.65         # クレジットカードも番号単体より周辺単語（カード番号等）を重視
PERSON_SCORE = 0.65     # 日本語名は誤検知しやすいため、コンテキストを重視
ROMAJI_NAME_SCORE = 0.55 # ローマ字名は誤検知しやすいため、コンテキストを必須に近い扱いに
ORG_SCORE = 0.75        # 組織名（コンテキスト依存を強化）
LOCATION_SCORE = 0.7    # 住所（コンテキスト依存）
MY_NUMBER_SCORE = 0.7
DRIVERS_LICENSE_SCORE = 0.7
PASSPORT_SCORE = 0.7
BANK_ACCOUNT_SCORE = 0.65  # コンテキスト重視
TAX_NUMBER_SCORE = 0.7
PASSWORD_SCORE = 0.85
SECRET_KEY_SCORE = 0.8   # コンテキスト重視
CERTIFICATE_SCORE = 0.95
SECURITY_CODE_SCORE = 0.55  # コンテキスト必須に近い
PIN_SCORE = 0.7  # 暗証番号（コンテキスト必須）

# 一般的な日本語単語の除外リスト（PERSONとして誤検知されやすい単語）
# セットとして定義して高速検索を可能にする
COMMON_JAPANESE_WORDS = {
    "情報", "記録", "作成", "承認", "更新", "削除", "追加", "変更", "設定",
    "管理", "システム", "プロジェクト", "リポジトリ", "アクセス", "権限",
    "読み取り", "書き込み", "履歴", "日時", "金額", "合計",
    "議題", "会議", "出席", "講師", "議長", "次回", "売上", "予算",
    "目標", "案件", "受注", "活動", "強化", "製品", "研修", "実施",
    "診断", "症状", "処方", "認証", "暗号化", "ポート", "制限",
    "鍵", "IP", "ブランチ", "保護", "必須", "送信", "受信",
    "ホスト", "ユーザー", "パスワード",
    "カテゴリー", "サブカテゴリー", "ドキュメント", "番号", "識別",
    "契約", "取引", "先", "備考", "名義", "環境", "接続", "データベース",
    "加盟店", "旅券", "表記", "出席者",
    "作成者", "承認者", "担当者", "部署", "役職", "営業部", "課長",
    "代表取締役", "取締役", "監査役", "部長", "係長", "主任",
    "生年月日", "作成日", "取引日", "氏名", "クレジット", "カード",
    "有効期限", "セキュリティコード", "決済", "支払", "振込", "口座",
    "銀行", "納税者", "登録", "法人", "インボイス", "マイナンバー",
    "個人番号", "通知", "運転", "免許証", "パスポート", "企業", "会社",
    "所属", "組織", "団体", "商店", "店舗", "支店"
}

# 一般的なビジネス用語の接尾辞パターン（正規表現用）
COMMON_SUFFIXES_PATTERN = r'(情報|記録|設定|管理|システム|プロジェクト|アクセス|権限|履歴|日時|金額|合計|議題|会議|出席|講師|議長|次回|売上|予算|目標|案件|受注|活動|強化|製品|研修|実施|診断|症状|処方|認証|暗号化|ポート|制限|送信|受信|ホスト|ユーザー|カテゴリー|サブカテゴリー|ドキュメント|識別|契約|取引|備考|名義|環境|接続|データベース|加盟店|旅券|表記|番号|作成者|承認者|担当者|部署|役職|営業部|課長|代表取締役|取締役|監査役|部長|係長|主任|生年月日|作成日|取引日|クレジット|カード|有効期限|セキュリティコード|決済|支払|振込|口座|銀行|納税者|登録|法人|インボイス|マイナンバー|個人番号|通知|運転|免許証|パスポート|企業|会社|所属|組織|団体|商店|店舗|支店)'

# --- コンテキスト単語の設定 ---
# 周辺にこれらの単語がある場合、検出スコアが向上します
# 汎用的な単語のみを使用（特定の固有名詞やサンプル特化の単語は削除）
CONTEXT_WORDS = {
    "PHONE_NUMBER": ["電話", "TEL", "連絡先", "携帯", "電話番号"],
    "CREDIT_CARD": ["カード番号", "クレジットカード", "カード", "決済", "支払"],
    "PERSON": ["氏名", "名前", "名義", "Name", "NAME", "担当", "様", "ローマ字", "表記", "代表者", "代表"],
    "ORG": ["企業", "会社", "所属", "組織", "団体", "取引先", "委託者", "受託者", "受取人名", "依頼人名", "名"],
    "ORGANIZATION": ["企業", "会社", "所属", "組織", "団体", "取引先", "委託者", "受託者", "受取人名", "依頼人名", "名"],
    "LOCATION": ["住所", "所在地", "住居", "本社", "支店", "住所地", "現住所"],
    "MY_NUMBER": ["マイナンバー", "個人番号", "通知カード"],
    "DRIVERS_LICENSE": ["運転免許証", "免許証", "第", "号"],
    "PASSPORT": ["パスポート", "旅券"],
    "BANK_ACCOUNT": ["口座番号", "口座", "振込先", "銀行"],
    "TAX_NUMBER": ["納税者番号", "登録番号", "法人番号", "インボイス"],
    "PASSWORD": ["パスワード", "Password", "PW", "PASS", "ログインパスワード", "PWD"],
    "SECRET_KEY": ["Secret", "Key", "APIキー", "API Key", "トークン", "Token", "Access Token", "アクセストークン"],
    "SECURITY_CODE": ["セキュリティコード", "CVV", "CVC", "CVV2", "CVC2"],
    "PIN": ["暗証番号", "PIN", "pin", "PINコード", "暗証", "キャッシュカード暗証番号", "カード暗証番号"],
}
